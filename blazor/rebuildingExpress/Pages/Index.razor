@page "/"
@inject IJSRuntime JSRuntime
@* @inject NavigationManager _nav *@

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.

<SurveyPrompt Title="How is Blazor working for you?" />

<button @onclick="NavigateToNewTab">Navigate to new tab</button>

@* This button takes you to popout page, but it doesn't display anything *@
@* <button @onclick="@(()=>_nav.NavigateTo("/popout"))" >pop out link</button> *@

<SubComponent />

@if (SwitchableLoad)
{
	<Switchable />
}


@* this came from here:
https://www.telerik.com/blogs/how-to-render-blazor-components-dynamically *@
@if (Components.Count > 0)
{
	@foreach (var component in Components)
	{
		<DynamicComponent Type="@component" />
	}
}

@code {

	public List<Type> Components { get; set; } = new List<Type>();

	public bool SwitchableLoad { get; set; } = false;

	protected override async Task OnInitializedAsync()
	{
		await Task.Delay(5000);
		SwitchableLoad = true;
		StateHasChanged();

		Components.Add(typeof(FetchData));
		Components.Add(typeof(Counter));
		StateHasChanged();
	}

	public async Task NavigateToNewTab()
	{
		string url = "/popout";
		await JSRuntime.InvokeVoidAsync("open", url, "_blank");
	}
}